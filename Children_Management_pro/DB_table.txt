-- 직급 테이블

drop table emp;
create table emp(
	emp_no number primary key,
	e_name varchar2(20) not null
);

insert into emp values(501, '원장');
insert into emp values(502, '원감');
insert into emp values(201, '주임교사');
insert into emp values(202, '담임교사');
insert into emp values(203, '부담임교사');

select * from emp;
commit;


-- 교실
drop sequence c_seq;
create sequence c_seq
	increment by 1
	start with 1
	minvalue 1
	nocache;

drop table classroom;
create table classroom(
	c_no number primary key,
	c_name varchar2(20) not null,
	c_age number not null
);

insert into classroom values(0, '전체관리자', 0); 
insert into classroom values(c_seq.nextval, '새싹반', 3);
insert into classroom values(c_seq.nextval, '열매반', 4);
insert into classroom values(c_seq.nextval, '햇살반', 5);
insert into classroom values(c_seq.nextval, '달님반', 5);

select * from classroom;
commit;


-- 회원(교사)
drop table teacher;
create table teacher(
	t_id varchar2(20) primary key, --영소문자 숫자 6~20
	t_pw varchar2(16) not null, -- 대문자 소문자 숫자 8~16
	c_no number not null,
	emp_no varchar2(20) not null,
	t_name varchar2(30) not null, -- 한글10글자, 영어30자
	t_phone varchar2(15) not null
);

insert into teacher values('sys', 'sys1234', 0, 501, '관리자', '010-2222-5555');

select * from teacher;
commit;



-- 이미지
drop table img;
create table img(
	img_id number primary key,
	img_name varchar2(50)
);

commit;

-- 학번시퀀스

drop sequence p_seq;
create sequence p_seq
	increment by 1
	start with 1
	minvalue 1
	nocache;



-- 학생
drop table person;
create table person(
	p_no number primary key,
	p_name varchar2(30) not null,
	p_birth date not null,
	gender varchar2(5) default '남' check(gender in('남','여')),
	p_entran date default sysdate not null , --입학일
	addr varchar2(120),
	img_id number,
	c_no number,
	note varchar2(100)
);


select * from person;
commit;

-- 가족
drop table family;
create table family(
	p_no number references person(p_no) on delete cascade, -- person(p_no)의 자식테이블
	f_relations varchar2(10) not null,
	f_name varchar2(30) not null,
	f_birth date,
	f_phone varchar2(15) not null
);


select * from family;
commit;


select * from person natural join family;


-- 학생객체가 생성되면 자동으로 학기만 데이터 생성하게 만들기
-- 신체발달
drop table physicalDev;
create table physicalDev(
	p_no number references person(p_no) on delete cascade, -- person(p_no)의 자식테이블
	pd_age varchar2(20) not null,
	pd_date varchar2(20) ,
	weight number default 0.0,
	height number default 0.0
);

insert into physicalDev values(220212, '3세 1학기', '2023-02-17' ,18.5 ,100.07);
select * from physicalDev;
commit;

select p_name, weight, height from physicalDev natural join person;


-- 출결상황
drop table attendManage;
create table attendManage(
	p_no number references person(p_no) on delete cascade, -- person(p_no)의 자식테이블
	attend number default 0 check(attend in(0,1)), -- 출석여부
	absence number default 0 check(absence in(0,1)), -- 결석여부
	earlier number default 0 check(earlier in(0,1)), -- 조퇴여부 
	classday number default 180, -- 수업일수
	adate date default sysdate -- 출결날짜관리
);

insert into attendManage(p_no) values(220212);
select * from attend_book;
commit;
